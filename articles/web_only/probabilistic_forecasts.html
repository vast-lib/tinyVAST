<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Probabilistic forecasts • tinyVAST</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../../favicon.ico">
<link rel="manifest" href="../../site.webmanifest">
<script src="../../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../../deps/headroom-0.11.0/headroom.min.js"></script><script src="../../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../../deps/search-1.0.0/fuse.min.js"></script><script src="../../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../../pkgdown.js"></script><meta property="og:title" content="Probabilistic forecasts">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../../index.html">tinyVAST</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.3.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../../articles/web_only/overview.html">Overview of vignettes</a></li>
    <li><a class="dropdown-item" href="../../articles/model-description.html">tinyVAST model description</a></li>
    <li><a class="dropdown-item" href="../../articles/mgcv.html">Comparison with mgcv</a></li>
    <li><a class="dropdown-item" href="../../articles/spatial.html">Spatial modeling</a></li>
    <li><a class="dropdown-item" href="../../articles/multiple_data.html">Multiple data types</a></li>
    <li><a class="dropdown-item" href="../../articles/dsem.html">Dynamic structural equation models</a></li>
    <li><a class="dropdown-item" href="../../articles/web_only/simultaneous_autoregressive_process.html">Simultaneous autoregressive process</a></li>
    <li><a class="dropdown-item" href="../../articles/web_only/stream_networks.html">Stream network models</a></li>
    <li><a class="dropdown-item" href="../../articles/web_only/age_composition_expansion.html">Age composition expansion</a></li>
    <li><a class="dropdown-item" href="../../articles/web_only/condition.html">Condition and density</a></li>
    <li><a class="dropdown-item" href="../../articles/web_only/empirical_orthogonal_functions.html">Empirical orthogonal functions</a></li>
    <li><a class="dropdown-item" href="../../articles/spatial_factor_analysis.html">Spatial factor analysis</a></li>
    <li><a class="dropdown-item" href="../../articles/web_only/VAST.html">Vector autoregressive spatio-temporal models</a></li>
    <li><a class="dropdown-item" href="../../articles/web_only/predator_expanded_diet.html">Predator expanded diet</a></li>
    <li><a class="dropdown-item" href="../../articles/web_only/spatial_structural_model.html">Spatial structural models</a></li>
    <li><a class="dropdown-item" href="../../articles/web_only/probabilistic_forecasts.html">Probabilistic forecasts</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/vast-lib/tinyVAST/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../../logo.png" class="logo" alt=""><h1>Probabilistic forecasts</h1>
                        <h4 data-toc-skip class="author">Arnaud Grüss,
James T. Thorson, Andrew J. Allyn</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/vast-lib/tinyVAST/blob/HEAD/vignettes/web_only/probabilistic_forecasts.Rmd" class="external-link"><code>vignettes/web_only/probabilistic_forecasts.Rmd</code></a></small>
      <div class="d-none name"><code>probabilistic_forecasts.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://inlabru-org.github.io/fmesher/" class="external-link">fmesher</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://vast-lib.github.io/tinyVAST/">tinyVAST</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="probabilistic-forecasts-with-spatio-temporal-models">Probabilistic forecasts with spatio-temporal models<a class="anchor" aria-label="anchor" href="#probabilistic-forecasts-with-spatio-temporal-models"></a>
</h2>
<p>We developed new approaches for forecasting with spatio-temporal
species distribution models (SDMs) that not only generate efficient
predictions, but also separate and quantify different sources of
prediction uncertainty <span class="citation">(Grüss et al.
n.d.)</span>. In these models, uncertainty can arise from: * Past
process errors — randomness in the estimated random effects that
represent past temporal, spatial, or spatio-temporal variation. * Future
process errors — uncertainty about how random effects will evolve into
the future. * Parameter uncertainty — variability in the estimated fixed
effects, which in turn affect the structure of the spatio-temporal
random fields.</p>
<p>These sources of uncertainty can be propagated with the function
<code>project</code>, which includes three key arguments:
<code>past_var</code>, <code>future_var</code>, and
<code>parm_var</code>. * <code>past_var</code> is a logical argument
which indicates whether to re-simulate past process errors from the
predictive distribution of random effects, thus changing the boundary
conditions of the forecasts. * <code>future_var</code> is a logical
argument which indicates whether to simulate future process errors from
Gaussian Markov Random Fields (GMRFs) or just compute the predictive
mean. * <code>parm_var</code> is a logical argument which indicates
whether to re-sample fixed effects from their predictive distribution,
thus changing the GMRFs for future process errors.</p>
<p>Here, we demonstrate one of our approaches, the “process error
resampling approach”, using fisheries-independent survey data for Bering
Sea capelin (Mallotus villosus) and generating forecasts to the next
century. For Bering Sea capelin, we first fit a delta-Gamma model to
biomass catch rate data and then use the fitted model to forecast the
index of relative biomass to the next century.</p>
<div class="section level3">
<h3 id="load-data-and-define-mesh">Load data and define mesh<a class="anchor" aria-label="anchor" href="#load-data-and-define-mesh"></a>
</h3>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span> <span class="va">bering_sea_capelin_forecasts</span> <span class="op">)</span></span>
<span><span class="va">Data</span> <span class="op">&lt;-</span> <span class="va">bering_sea_capelin_forecasts</span><span class="op">$</span><span class="va">Data</span> </span>
<span><span class="va">Data</span><span class="op">$</span><span class="va">var</span> <span class="op">&lt;-</span> <span class="st">"capelin"</span></span>
<span></span>
<span><span class="co"># Make mess</span></span>
<span><span class="va">mesh</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://inlabru-org.github.io/fmesher/reference/fm_mesh_2d.html" class="external-link">fm_mesh_2d</a></span><span class="op">(</span> <span class="va">Data</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Lon"</span>,<span class="st">"Lat"</span><span class="op">)</span><span class="op">]</span>, cutoff <span class="op">=</span> <span class="fl">1</span> <span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="define-autoregressive-structure">Define autoregressive structure<a class="anchor" aria-label="anchor" href="#define-autoregressive-structure"></a>
</h3>
<p>We next define an autoregressive structure to allow hotspots to be
propagated forward in time. For the Bering Sea capelin application
below, preliminary analyses determined that spatio-temporal variation
should be modelled as an AR1 process in both linear predictors of the
spatio-temporal SDMs. However, dynamics could instead be fitted and
forecasted using a single linear predictor using the Tweedie
distribution.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Define spatial variation</span></span>
<span><span class="va">space_term</span> <span class="op">&lt;-</span> <span class="st">"</span></span>
<span><span class="st">  capelin &lt;-&gt; capelin, sd_space</span></span>
<span><span class="st">"</span></span>
<span></span>
<span><span class="co"># Define temporal and spatio-temporal variation based on the outcomes of preliminary analyses</span></span>
<span><span class="va">time_term</span> <span class="op">&lt;-</span> <span class="st">"</span></span>
<span><span class="st">  capelin &lt;-&gt; capelin, 0, IID_sd</span></span>
<span><span class="st">"</span></span>
<span><span class="va">spacetime_term</span> <span class="op">&lt;-</span> <span class="st">"</span></span>
<span><span class="st">  capelin &lt;-&gt; capelin, 0, sd_spacetime</span></span>
<span><span class="st">  capelin -&gt; capelin, 1, ar1_spacetime</span></span>
<span><span class="st">"</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="fit-model">Fit model<a class="anchor" aria-label="anchor" href="#fit-model"></a>
</h3>
<p>Finally, we fit the model</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Fit the model (turning off use_anisotropy to save time)</span></span>
<span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/tinyVAST.html">tinyVAST</a></span><span class="op">(</span></span>
<span>  formula <span class="op">=</span> <span class="va">Wt</span> <span class="op">~</span> <span class="fl">1</span> <span class="op">+</span> <span class="va">sst_anomaly</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/offset.html" class="external-link">offset</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">AreaSwept_km2</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">Data</span>,</span>
<span>  space_term <span class="op">=</span> <span class="va">space_term</span>,</span>
<span>  spacetime_term <span class="op">=</span> <span class="va">spacetime_term</span>,</span>
<span>  time_term <span class="op">=</span> <span class="va">time_term</span>,</span>
<span>  family <span class="op">=</span> <span class="fu"><a href="../../reference/families.html">delta_gamma</a></span><span class="op">(</span> type <span class="op">=</span> <span class="st">"poisson-link"</span> <span class="op">)</span>,</span>
<span>  delta_options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    formula <span class="op">=</span> <span class="op">~</span> <span class="fl">1</span>,</span>
<span>    space_term <span class="op">=</span> <span class="va">space_term</span>,</span>
<span>    spacetime_term <span class="op">=</span> <span class="va">spacetime_term</span>,</span>
<span>    time_term <span class="op">=</span> <span class="va">time_term</span></span>
<span>  <span class="op">)</span>,</span>
<span>  spatial_domain <span class="op">=</span> <span class="va">mesh</span>,</span>
<span>  control <span class="op">=</span> <span class="fu"><a href="../../reference/tinyVASTcontrol.html">tinyVASTcontrol</a></span><span class="op">(</span></span>
<span>    use_anisotropy <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span>,</span>
<span>  space_columns <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Lon"</span>,<span class="st">"Lat"</span><span class="op">)</span>,</span>
<span>  time_column <span class="op">=</span> <span class="st">"Year"</span>,</span>
<span>  variable_column <span class="op">=</span> <span class="st">"var"</span>,</span>
<span>  variables <span class="op">=</span> <span class="st">"capelin"</span>,</span>
<span>  spatial_varying <span class="op">=</span> <span class="op">~</span> <span class="fl">0</span> <span class="op">+</span> <span class="va">sst_anomaly</span>,</span>
<span>  times <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">Data</span><span class="op">$</span><span class="va">Year</span><span class="op">)</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">Data</span><span class="op">$</span><span class="va">Year</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="projections-and-forecasts">Projections and forecasts<a class="anchor" aria-label="anchor" href="#projections-and-forecasts"></a>
</h3>
<p>The process error resampling approach involves three steps. * Step 1
consists of estimating uncertainty in the random effects of temporal,
spatial and/or spatio-temporal variation using the precision (inner
Hessian) matrix for random effects, conditional upon maximum-likelihood
estimates for fixed effects; * Step 2 consists of resampling the
temporal, spatial and/or spatio-temporal variation random effects from
their estimated distribution to produce parameter draws. * Step 3
consists of sampling values for random effects during the forecast
period from their conditional distribution, starting from the resampled
value of random effects in the most recent year of data as initial
condition, using the conditional krigging formula. To implement the
process error resampling approach, the following settings are needed in
the function <code>project</code>: <code>past_var = TRUE</code>,
<code>future_var = TRUE</code>, and <code>parm_var = FALSE</code>.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Generate projections </span></span>
<span><span class="co"># (using 50 candidate parameter draws to speed up vignette)</span></span>
<span><span class="va">New_Data</span> <span class="op">&lt;-</span> <span class="va">bering_sea_capelin_forecasts</span><span class="op">$</span><span class="va">New_Data</span></span>
<span><span class="va">projected_index</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span></span>
<span><span class="kw">for</span><span class="op">(</span> <span class="va">rI</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">50</span> <span class="op">)</span><span class="op">{</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">message</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.time</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">": starting "</span>, <span class="va">rI</span> <span class="op">)</span></span>
<span>  <span class="va">proj</span> <span class="op">=</span> <span class="fu"><a href="../../reference/project.html">project</a></span><span class="op">(</span></span>
<span>    object <span class="op">=</span> <span class="va">fit</span>,</span>
<span>    newdata <span class="op">=</span> <span class="va">New_Data</span>,</span>
<span>    extra_times <span class="op">=</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">Data</span><span class="op">$</span><span class="va">Year</span><span class="op">)</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">New_Data</span><span class="op">$</span><span class="va">Year</span><span class="op">)</span>,</span>
<span>    past_var <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    future_var <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    parm_var <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span></span>
<span>  <span class="va">index_t</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tapply.html" class="external-link">tapply</a></span><span class="op">(</span> <span class="va">proj</span>, INDEX <span class="op">=</span> <span class="va">New_Data</span><span class="op">$</span><span class="va">Year</span>, FUN <span class="op">=</span> <span class="va">sum</span> <span class="op">)</span></span>
<span>  <span class="va">projected_index</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span> <span class="va">projected_index</span>, <span class="va">index_t</span> <span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>We can then plot and inspect the predictive interval, to confirm that
bridges uncertainty between short-term forecasts and long-term
projections</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Plot the projected index of relative biomass</span></span>
<span><span class="va">Y_tq</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span> <span class="va">projected_index</span>, MARGIN <span class="op">=</span> <span class="fl">1</span>, FUN <span class="op">=</span> <span class="va">quantile</span>, </span>
<span>                  probs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span> <span class="fl">0.1</span>, <span class="fl">0.5</span>, <span class="fl">0.9</span> <span class="op">)</span> <span class="op">)</span> <span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">Y_tq</span><span class="op">)</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"lower"</span>, <span class="st">"abundance"</span>, <span class="st">"upper"</span><span class="op">)</span></span>
<span><span class="va">DF</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span> Year <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">Y_tq</span><span class="op">)</span><span class="op">)</span>, <span class="va">Y_tq</span> <span class="op">)</span> </span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span> <span class="va">DF</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">Year</span><span class="op">)</span> <span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y<span class="op">=</span><span class="va">abundance</span><span class="op">)</span> <span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_linerange.html" class="external-link">geom_errorbar</a></span><span class="op">(</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>ymax<span class="op">=</span><span class="va">upper</span>, ymin <span class="op">=</span> <span class="va">lower</span><span class="op">)</span> <span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_log10</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="probabilistic_forecasts_files/figure-html/unnamed-chunk-6-1.png" width="576"></p>
</div>
<div class="section level3">
<h3 id="alternative-options">Alternative options<a class="anchor" aria-label="anchor" href="#alternative-options"></a>
</h3>
<p>Another approach to forecasting with spatio-temporal SDMs that we
developed is the “conditional approach.” The conditional approach
implements only Step 3 from the process error resampling approach, and
conditions samples for random effects in the forecast period using as
initial conditions the empirical Bayes predictions of random effects in
the most recent year of data.<br>
To implement the conditional approach, the following settings are needed
in the function <code>project</code>: <code>past_var = FALSE</code>,
<code>future_var = TRUE</code>, and <code>parm_var = FALSE</code>.</p>
<p>We also developed approach to forecasting with spatio-temporal SDMs
called the “mixed effects resampling approach,” which considers
uncertainty in both fixed and random effects for generating forecasts,
using the joint precision matrix. The mixed effects resampling approach:
1. assumes that the collection of fixed and random effect parameters of
a spatio-temporal SDM can be described by a multivariate normal (MVN)
distribution with mean values equal to the maximum likelihood estimates
and variability defined from a covariance dependency matrix; and 2.
samples from this MVN distribution to produce forecasts. However,
preliminary analyses revealed that the mixed effects resampling approach
work for some fish populations, but not others; in brief, the mixed
effects resampling approach works well when variances are relatively
low, but poorly for fish populations when variances are high and likely
non-normal. To implement the mixed effects resampling approach, the
following settings are needed in the function <code>project</code>:
<code>past_var = TRUE</code>, <code>future_var = TRUE</code>, and
<code>parm_var = TRUE</code>.</p>
<p>One important consideration when generating forecasts with
spatio-temporal SDMs are autoregressive structures on temporal and
spatio-temporal variation:</p>
<ul>
<li><p>Regarding temporal variation, analysts may prefer to model
temporal variation first as a first-order autoregressive (AR1) process
and then, if the estimated degree of autocorrelation in temporal
variation approaches one, as a random walk (RW) process. If modelling
temporal variation as an AR1 or a RW process proves unwarranted (e.g.,
because the variance of temporal variation approaches zero), it can
instead be modelled (1) as an independent and identically distributed
(IID) random effect, which sets the variance of temporal variation to
zero, or, as a last resort, (1) as a constant, fixed effect, which sets
both the estimated degree of autocorrelation in temporal variation and
the variance of temporal variation to zero. Preliminary analyses are
needed to identify the best autoregressive structures on temporal
variation, allowing for both model estimation/convergence and sensible
future predictions. For the Bering Sea capelin application below,
preliminary analyses determined that temporal variation should be
modelled as a random IID effect in both linear predictors of the
spatio-temporal SDMs.</p></li>
<li><p>Regarding spatio-temporal variation, analysts may model
spatio-temporal variation as an AR1 process, a RW process, or an IID
random effect. However, analysts may prefer to model spatio-temporal
variation as an AR1 process rather than as a RW process, because the
latter results in the spatio-temporal variation term having a variance
across space that increases progressively during the forecast period.
Then, when spatio-temporal variation is extrapolated to calculate
densities, forecasted indices of relative abundance are progressively
dominated by the predicted density at a few (or single) extrapolation
location(s).</p></li>
</ul>
<p>Runtime for this vignette: 7.78 mins</p>
</div>
</div>
<div class="section level2">
<h2 class="unnumbered" id="works-cited">Works cited<a class="anchor" aria-label="anchor" href="#works-cited"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-gruss_probabilistic_nodate" class="csl-entry">
Grüss, Arnaud, Andrew J. Allyn, James T. Thorson, Katherine E. Mills,
Ellen Yasumiishi, Matthew H. Pinkerton, Darren M. Parsons, and Nokuthaba
Sibanda. n.d. <span>“Probabilistic <span>Forecasts</span> of
<span>Fish</span> <span>Abundances</span> <span>With</span>
<span>Spatio</span>-<span>Temporal</span> <span>Models</span> to
<span>Support</span> <span>Fisheries</span>
<span>Management</span>.”</span> <em>Fish and Fisheries</em> n/a (n/a).
Accessed September 8, 2025. <a href="https://doi.org/10.1111/faf.70025" class="external-link">https://doi.org/10.1111/faf.70025</a>.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by James T. Thorson, Sean C. Anderson.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
