<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>tinyVAST model description • tinyVAST</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="tinyVAST model description">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">tinyVAST</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/web_only/overview.html">Overview of vignettes</a></li>
    <li><a class="dropdown-item" href="../articles/model-description.html">tinyVAST model description</a></li>
    <li><a class="dropdown-item" href="../articles/mgcv.html">Comparison with mgcv</a></li>
    <li><a class="dropdown-item" href="../articles/spatial.html">Spatial modeling</a></li>
    <li><a class="dropdown-item" href="../articles/multiple_data.html">Multiple data types</a></li>
    <li><a class="dropdown-item" href="../articles/dsem.html">Dynamic structural equation models</a></li>
    <li><a class="dropdown-item" href="../articles/simultaneous_autoregressive_process.html">Simultaneous autoregressive process</a></li>
    <li><a class="dropdown-item" href="../articles/web_only/stream_networks.html">Stream network models</a></li>
    <li><a class="dropdown-item" href="../articles/web_only/age_composition_expansion.html">Age composition expansion</a></li>
    <li><a class="dropdown-item" href="../articles/web_only/condition.html">Condition and density</a></li>
    <li><a class="dropdown-item" href="../articles/web_only/empirical_orthogonal_functions.html">Empirical orthogonal functions</a></li>
    <li><a class="dropdown-item" href="../articles/spatial_factor_analysis.html">Spatial factor analysis</a></li>
    <li><a class="dropdown-item" href="../articles/web_only/VAST.html">Vector autoregressive spatio-temporal models</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/vast-lib/tinyVAST/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>tinyVAST model description</h1>
                        <h4 data-toc-skip class="author">James T.
Thorson</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/vast-lib/tinyVAST/blob/HEAD/vignettes/model-description.Rmd" class="external-link"><code>vignettes/model-description.Rmd</code></a></small>
      <div class="d-none name"><code>model-description.Rmd</code></div>
    </div>

    
    
<!-- math bold nonitalic -->
<!-- math nonitalic -->
<div class="section level2">
<h2 id="bivariate-generalized-linear-mixed-model-structure">Bivariate generalized linear mixed model structure<a class="anchor" aria-label="anchor" href="#bivariate-generalized-linear-mixed-model-structure"></a>
</h2>
<p>tinyVAST is a bivariate extension of a generalized linear mixed model
(see Tables 1 and 2 for notation), which includes two linear predictors
that each include four additive components:</p>
<ol style="list-style-type: decimal">
<li><p><em>Spatial interactions among variables</em>: The user can
specify interactions among variables at a given site (or for spatially
correlated latent variables) using arrow notation derived from path
analysis, based on the interface from R package sem;</p></li>
<li><p><em>Temporal interaction among variables</em>: The user can
specify simultaneous and lagged interactions among variables over time
using an expanded arrow-and-lag notation that is derived from R package
dsem, where these interactions the annual intercept for a given variable
therefore apply uniformly for all locations.</p></li>
<li><p><em>Spatio-temporal interactions among variables</em>: The user
can specify simultaneous and lagged interactions among variables over
time, where these interactions occur on a site-by-site basis.</p></li>
<li><p><em>Generalized additive model</em>: The user specifies a formula
for a generalized additive model (GAM) that is interpreted by R package
mgcv. If other model components are missing, tinyVAST estimates
parameters that are similar to mgcv, with small differences resulting
from different methods for parameter estimation;</p></li>
</ol>
<p>These four components are assembled into two linear predictors:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><msub><mi>p</mi><mrow><mn mathvariant="normal">1</mn><mo>,</mo><mi>i</mi></mrow></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><msub><mi>𝐗</mi><mrow><mn mathvariant="normal">1</mn><mo>,</mo><mi>i</mi></mrow></msub><msub><mi>𝛂</mi><mn mathvariant="normal">1</mn></msub><mo>+</mo><msub><mi>𝐙</mi><mrow><mn mathvariant="normal">1</mn><mo>,</mo><mi>i</mi></mrow></msub><msub><mi>𝛄</mi><mn mathvariant="normal">1</mn></msub><mo>+</mo><msub><mi>𝐀</mi><mi>i</mi></msub><msub><mi>𝛀</mi><mrow><mn mathvariant="normal">1</mn><mo>,</mo><mi>c</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>i</mi><mo stretchy="true" form="postfix">]</mo></mrow></mrow></msub><mo>+</mo><msub><mi>𝐃</mi><mrow><mn mathvariant="normal">1</mn><mo>,</mo><mi>c</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>i</mi><mo stretchy="true" form="postfix">]</mo></mrow><mo>,</mo><mi>t</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>i</mi><mo stretchy="true" form="postfix">]</mo></mrow></mrow></msub><mo>+</mo><msub><mi>𝐀</mi><mi>i</mi></msub><msub><mi>𝐄</mi><mrow><mn mathvariant="normal">1</mn><mo>,</mo><mi>c</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>i</mi><mo stretchy="true" form="postfix">]</mo></mrow><mo>,</mo><mi>t</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>i</mi><mo stretchy="true" form="postfix">]</mo></mrow></mrow></msub></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><msub><mi>p</mi><mrow><mn mathvariant="normal">2</mn><mo>,</mo><mi>i</mi></mrow></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><msub><mi>𝐗</mi><mrow><mn mathvariant="normal">2</mn><mo>,</mo><mi>i</mi></mrow></msub><msub><mi>𝛂</mi><mn mathvariant="normal">2</mn></msub><mo>+</mo><msub><mi>𝐙</mi><mrow><mn mathvariant="normal">2</mn><mo>,</mo><mi>i</mi></mrow></msub><msub><mi>𝛄</mi><mn mathvariant="normal">2</mn></msub><mo>+</mo><msub><mi>𝐀</mi><mi>i</mi></msub><msub><mi>𝛀</mi><mrow><mn mathvariant="normal">2</mn><mo>,</mo><mi>c</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>i</mi><mo stretchy="true" form="postfix">]</mo></mrow></mrow></msub><mo>+</mo><msub><mi>𝐃</mi><mrow><mn mathvariant="normal">2</mn><mo>,</mo><mi>c</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>i</mi><mo stretchy="true" form="postfix">]</mo></mrow><mo>,</mo><mi>t</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>i</mi><mo stretchy="true" form="postfix">]</mo></mrow></mrow></msub><mo>+</mo><msub><mi>𝐀</mi><mi>i</mi></msub><msub><mi>𝐄</mi><mrow><mn mathvariant="normal">2</mn><mo>,</mo><mi>c</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>i</mi><mo stretchy="true" form="postfix">]</mo></mrow><mo>,</mo><mi>t</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>i</mi><mo stretchy="true" form="postfix">]</mo></mrow></mrow></msub></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{aligned}
p_{\mathrm 1,i} &amp;= \mathbf X_{\mathrm 1,i} \mathbf\alpha_{\mathrm 1} + \mathbf Z_{\mathrm 1,i} \mathbf\gamma_{\mathrm 1} + \mathbf A_{i} \mathbf\Omega_{\mathrm 1,c[i]} + \mathbf D_{\mathrm 1,c[i],t[i]} + \mathbf A_i \mathbf E_{\mathrm 1,c[i],t[i]}  \\
p_{\mathrm 2,i} &amp;= \mathbf X_{\mathrm 2,i} \mathbf\alpha_{\mathrm 2} + \mathbf Z_{\mathrm 2,i} \mathbf\gamma_{\mathrm 2} + \mathbf A_{i} \mathbf\Omega_{\mathrm 2,c[i]} + \mathbf D_{\mathrm 2,c[i],t[i]} + \mathbf A_i \mathbf E_{\mathrm 2,c[i],t[i]}
\end{aligned}
</annotation></semantics></math></p>
<p>where</p>
<ul>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>p</mi><mrow><mn mathvariant="normal">1</mn><mo>,</mo><mi>i</mi></mrow></msub><annotation encoding="application/x-tex">p_{\mathrm 1,i}</annotation></semantics></math>
is the first linear predictor;</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>𝐗</mi><mrow><mn mathvariant="normal">1</mn><mo>,</mo><mi>i</mi></mrow></msub><msub><mi>𝛂</mi><mn mathvariant="normal">1</mn></msub><mo>+</mo><msub><mi>𝐙</mi><mrow><mn mathvariant="normal">1</mn><mo>,</mo><mi>i</mi></mrow></msub><msub><mi>𝛄</mi><mn mathvariant="normal">1</mn></msub></mrow><annotation encoding="application/x-tex">\mathbf X_{\mathrm 1,i} \mathbf\alpha_{\mathrm 1} + \mathbf Z_{\mathrm 1,i} \mathbf\gamma_{\mathrm 1}</annotation></semantics></math>
is the GAM component</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>𝛂</mi><mn mathvariant="normal">1</mn></msub><annotation encoding="application/x-tex">\mathbf\alpha_{\mathrm 1}</annotation></semantics></math>
is the GAM fixed effects with associated design matrix
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>𝐗</mi><mn mathvariant="normal">1</mn></msub><annotation encoding="application/x-tex">\mathbf X_{\mathrm 1}</annotation></semantics></math>,
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>𝐗</mi><mrow><mn mathvariant="normal">1</mn><mo>,</mo><mi>i</mi></mrow></msub><annotation encoding="application/x-tex">\mathbf X_{\mathrm 1,i}</annotation></semantics></math>
is the row of the design matrix for sample
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>;</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>𝛄</mi><mn mathvariant="normal">1</mn></msub><annotation encoding="application/x-tex">\mathbf\gamma_{\mathrm 1}</annotation></semantics></math>
is the GAM random effects with associated design matrix
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>𝐙</mi><annotation encoding="application/x-tex">\mathbf Z</annotation></semantics></math>,
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>𝐙</mi><mrow><mn mathvariant="normal">1</mn><mo>,</mo><mi>i</mi></mrow></msub><annotation encoding="application/x-tex">\mathbf Z_{\mathrm 1,i}</annotation></semantics></math>
is the row of the design matrix;</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>𝐀</mi><mi>i</mi></msub><msub><mi>𝛀</mi><mrow><mn mathvariant="normal">1</mn><mo>,</mo><mi>c</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>i</mi><mo stretchy="true" form="postfix">]</mo></mrow></mrow></msub></mrow><annotation encoding="application/x-tex">\mathbf A_{i} \mathbf\Omega_{\mathrm 1,c[i]}</annotation></semantics></math>
is the projection of the space-veriable interaction
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>𝛀</mi><annotation encoding="application/x-tex">\mathbf\Omega</annotation></semantics></math>
to sample
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>;</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>𝐃</mi><mrow><mn mathvariant="normal">1</mn><mo>,</mo><mi>c</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>i</mi><mo stretchy="true" form="postfix">]</mo></mrow><mo>,</mo><mi>t</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>i</mi><mo stretchy="true" form="postfix">]</mo></mrow></mrow></msub><annotation encoding="application/x-tex">\mathbf D_{\mathrm 1,c[i],t[i]}</annotation></semantics></math>
is the time-variable interaction
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>𝐃</mi><annotation encoding="application/x-tex">\mathbf D</annotation></semantics></math>
for sample
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>;</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>𝐀</mi><mi>i</mi></msub><msub><mi>𝐄</mi><mrow><mn mathvariant="normal">1</mn><mo>,</mo><mi>c</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>i</mi><mo stretchy="true" form="postfix">]</mo></mrow><mo>,</mo><mi>t</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>i</mi><mo stretchy="true" form="postfix">]</mo></mrow></mrow></msub></mrow><annotation encoding="application/x-tex">\mathbf A_i \mathbf E_{\mathrm 1,c[i],t[i]}</annotation></semantics></math>
is the projection of the space-variable-time interaction
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>𝐄</mi><annotation encoding="application/x-tex">\mathbf E</annotation></semantics></math>
to sample
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>;</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>p</mi><mrow><mn mathvariant="normal">2</mn><mo>,</mo><mi>i</mi></mrow></msub><annotation encoding="application/x-tex">p_{\mathrm 2,i}</annotation></semantics></math>
is the second linear predictor, and terms are defined similarly but
using subscript-2;</li>
</ul>
<p>The linear predictors are then passed through a bivariate
inverse-link function to specify the distribution for errors:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>y</mi><mi>i</mi></msub><mo>∼</mo><msub><mi>f</mi><mrow><mi>e</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>i</mi><mo stretchy="true" form="postfix">]</mo></mrow></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><msubsup><mi>g</mi><mrow><mi>e</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>i</mi><mo stretchy="true" form="postfix">]</mo></mrow></mrow><mrow><mo>−</mo><mn>1</mn></mrow></msubsup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>p</mi><mrow><mn mathvariant="normal">1</mn><mo>,</mo><mi>i</mi></mrow></msub><mo>,</mo><msub><mi>p</mi><mrow><mn mathvariant="normal">2</mn><mo>,</mo><mi>i</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo><msub><mi>θ</mi><mrow><mi>e</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>i</mi><mo stretchy="true" form="postfix">]</mo></mrow></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">
y_i \sim f_{e[i]}( g_{e[i]}^{-1} (p_{\mathrm 1,i}, p_{\mathrm 2,i}), \theta_{e[i]} )
</annotation></semantics></math></p>
<p>where</p>
<ul>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>f</mi><mrow><mi>e</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>i</mi><mo stretchy="true" form="postfix">]</mo></mrow></mrow></msub><annotation encoding="application/x-tex">f_{e[i]}</annotation></semantics></math>
probability density or mass function for sample
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>;</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>g</mi><mrow><mi>e</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>i</mi><mo stretchy="true" form="postfix">]</mo></mrow></mrow><mrow><mo>−</mo><mn>1</mn></mrow></msubsup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>p</mi><mrow><mn mathvariant="normal">1</mn><mo>,</mo><mi>i</mi></mrow></msub><mo>,</mo><msub><mi>p</mi><mrow><mn mathvariant="normal">2</mn><mo>,</mo><mi>i</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">g_{e[i]}^{-1} (p_{\mathrm 1,i}, p_{\mathrm 2,i})</annotation></semantics></math>
is the bivariate inverse-link function that transforms linear predictors
to the central tendancy parameters of the distribution;</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>θ</mi><mrow><mi>e</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>i</mi><mo stretchy="true" form="postfix">]</mo></mrow></mrow></msub><annotation encoding="application/x-tex">\theta_{e[i]}</annotation></semantics></math>
is the dispersion parameters for distribution
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>e</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>i</mi><mo stretchy="true" form="postfix">]</mo></mrow></mrow><annotation encoding="application/x-tex">e[i]</annotation></semantics></math>;</li>
</ul>
<p>In the simple case, the distribution only requires a single linear
predictor such that
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>𝐩</mi><mn mathvariant="normal">2</mn></msub><mo>=</mo><mn>𝟎</mn></mrow><annotation encoding="application/x-tex">\mathbf p_{\mathrm 2} = \mathbf 0</annotation></semantics></math>
by construction and drops out of the model. In this case, the model
collapses to a generalized linear mixed model. For example we might have
a log-link and Poisson distribution, such that it collapses to a
log-linked Poisson GLMM,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>y</mi><mi>i</mi></msub><mo>∼</mo><mrow><mi mathvariant="normal">P</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">s</mi><mi mathvariant="normal">s</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">n</mi></mrow><mrow><mo stretchy="true" form="prefix">(</mo><msup><mi>e</mi><msub><mi>p</mi><mrow><mn mathvariant="normal">1</mn><mo>,</mo><mi>i</mi></mrow></msub></msup><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">y_i \sim \mathrm{Poisson}(e^{p_{\mathrm 1,i}})</annotation></semantics></math>.</p>
<p>However, tinyVAST can also handle a delta-model using either
logit-log or Poisson-linked link functions:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>g</mi><mrow><mi>e</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>i</mi><mo stretchy="true" form="postfix">]</mo></mrow></mrow><mrow><mo>−</mo><mn>1</mn></mrow></msubsup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>p</mi><mrow><mn mathvariant="normal">1</mn><mo>,</mo><mi>i</mi></mrow></msub><mo>,</mo><msub><mi>p</mi><mrow><mn mathvariant="normal">2</mn><mo>,</mo><mi>i</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>μ</mi><mrow><mn mathvariant="normal">1</mn><mo>,</mo><mi>i</mi></mrow></msub><mo>,</mo><msub><mi>μ</mi><mrow><mn mathvariant="normal">2</mn><mo>,</mo><mi>i</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">
g_{e[i]}^{-1} (p_{\mathrm 1,i}, p_{\mathrm 2,i}) = ( \mu_{\mathrm 1,i}, \mu_{\mathrm 2,i}  )
</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>μ</mi><mrow><mn mathvariant="normal">1</mn><mo>,</mo><mi>i</mi></mrow></msub><annotation encoding="application/x-tex">\mu_{\mathrm 1,i}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>μ</mi><mrow><mn mathvariant="normal">2</mn><mo>,</mo><mi>i</mi></mrow></msub><annotation encoding="application/x-tex">\mu_{\mathrm 2,i}</annotation></semantics></math>
are the two linear predictors, such that
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>𝔼</mi><mrow><mo stretchy="true" form="prefix">[</mo><msub><mi>y</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">]</mo></mrow><mo>=</mo><msub><mi>μ</mi><mrow><mn mathvariant="normal">1</mn><mo>,</mo><mi>i</mi></mrow></msub><msub><mi>μ</mi><mrow><mn mathvariant="normal">2</mn><mo>,</mo><mi>i</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\mathbb{E}[y_i] = \mu_{\mathrm 1,i} \mu_{\mathrm 2,i}</annotation></semantics></math>;</p>
<p>For the conventional logit-log bivariate link function we obtain:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><msub><mi>μ</mi><mrow><mn mathvariant="normal">1</mn><mo>,</mo><mi>i</mi></mrow></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mfrac><msup><mi>e</mi><msub><mi>p</mi><mrow><mn mathvariant="normal">1</mn><mo>,</mo><mi>i</mi></mrow></msub></msup><mrow><mn>1</mn><mo>+</mo><msup><mi>e</mi><msub><mi>p</mi><mrow><mn mathvariant="normal">1</mn><mo>,</mo><mi>i</mi></mrow></msub></msup></mrow></mfrac></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><msub><mi>μ</mi><mrow><mn mathvariant="normal">2</mn><mo>,</mo><mi>i</mi></mrow></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><msup><mi>e</mi><msub><mi>p</mi><mrow><mn mathvariant="normal">2</mn><mo>,</mo><mi>i</mi></mrow></msub></msup></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{aligned}
\mu_{\mathrm 1,i} &amp;= \frac{e^{p_{\mathrm 1,i}}}{1+e^{p_{\mathrm 1,i}}}  \\
\mu_{\mathrm 2,i} &amp;= e^{p_{\mathrm 2,i}}
\end{aligned}
</annotation></semantics></math></p>
<p>while for the Poisson-linked link function we obtain:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><msub><mi>μ</mi><mrow><mn mathvariant="normal">1</mn><mo>,</mo><mi>i</mi></mrow></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mn>1</mn><mo>−</mo><msup><mi>e</mi><mrow><mo>−</mo><msub><mi>p</mi><mrow><mn mathvariant="normal">1</mn><mo>,</mo><mi>i</mi></mrow></msub></mrow></msup></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><msub><mi>μ</mi><mrow><mn mathvariant="normal">2</mn><mo>,</mo><mi>i</mi></mrow></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mfrac><msup><mi>e</mi><msub><mi>p</mi><mrow><mn mathvariant="normal">1</mn><mo>,</mo><mi>i</mi></mrow></msub></msup><msub><mi>μ</mi><mrow><mn mathvariant="normal">1</mn><mo>,</mo><mi>i</mi></mrow></msub></mfrac><msup><mi>e</mi><msub><mi>p</mi><mrow><mn mathvariant="normal">2</mn><mo>,</mo><mi>i</mi></mrow></msub></msup></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{aligned}
\mu_{\mathrm 1,i} &amp;= 1 - e^{-p_{\mathrm 1,i}} \\
\mu_{\mathrm 2,i} &amp;= \frac{e^{p_{\mathrm 1,i}}}{\mu_{\mathrm 1,i}} e^{p_{\mathrm 2,i}}
\end{aligned}
</annotation></semantics></math></p>
<p>In either case,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>μ</mi><mrow><mn mathvariant="normal">1</mn><mo>,</mo><mi>i</mi></mrow></msub><annotation encoding="application/x-tex">\mu_{\mathrm 1,i}</annotation></semantics></math>
is the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mi mathvariant="normal">P</mi><mi mathvariant="normal">r</mi></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>Y</mi><mo>&gt;</mo><mn>0</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\mathrm{Pr}(Y&gt;0)</annotation></semantics></math>
(and is fitted with a Bernoulli distribution), while
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>μ</mi><mrow><mn mathvariant="normal">2</mn><mo>,</mo><mi>i</mi></mrow></msub><annotation encoding="application/x-tex">\mu_{\mathrm 2,i}</annotation></semantics></math>
is the central tendancy for positive values, i.e.,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>𝔼</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>Y</mi><mo stretchy="false" form="prefix">|</mo><mi>Y</mi><mo>&gt;</mo><mn>0</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msub><mi>μ</mi><mrow><mn mathvariant="normal">2</mn><mo>,</mo><mi>i</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\mathbb{E}(Y | Y&gt;0) = \mu_{\mathrm 2,i}</annotation></semantics></math>.</p>
</div>
<div class="section level2">
<h2 id="spatial-domains">Spatial domains<a class="anchor" aria-label="anchor" href="#spatial-domains"></a>
</h2>
<p>Linear predictors include spatially autocorrelated latent variables.
These variables are treated as Gaussian Markov random fields (GMRFs),
and evaluating the probability density of GMRFs involves calculating the
precision matrix
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>𝐐</mi><mrow><mi mathvariant="normal">d</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">m</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">n</mi></mrow></msub><mo>=</mo><msup><mi>𝚺</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">\mathbf Q_{\mathrm{domain}} = \mathbf\Sigma^{-1}</annotation></semantics></math>
as the inverse of the spatial covariance matrix. tinyVAST involves three
options for specifying this spatial precision:</p>
<ul>
<li>Stochastic partial differentiaul equation (SPDE): The analyst can
approximate spatial variation over a continuous two-dimensional surface
by constructing finite element mesh (FEM), treating the value at
vertices as a GMRF, and then using bilinear interpolation (i.e., a
piecewise linear approximation) to interpolate from vertices to the
spatial domain. In this case, the precision is constructred as:</li>
</ul>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>𝐐</mi><mrow><mi mathvariant="normal">d</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">m</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">n</mi></mrow></msub><mo>=</mo><msup><mi>τ</mi><mn>2</mn></msup><mrow><mo stretchy="true" form="prefix">(</mo><msup><mi>κ</mi><mn>4</mn></msup><msub><mi>𝐌</mi><mn mathvariant="normal">0</mn></msub><mo>+</mo><mn>2</mn><msup><mi>κ</mi><mn>2</mn></msup><msub><mi>𝐌</mi><mn mathvariant="normal">1</mn></msub><mo>+</mo><msub><mi>𝐌</mi><mn mathvariant="normal">2</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">
\mathbf Q_{\mathrm{domain}} = \tau^2 ( \kappa^4 \mathbf M_{\mathrm 0} + 2\kappa^2 \mathbf M_{\mathrm 1} + \mathbf M_{\mathrm 2} )
</annotation></semantics></math> where every row
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>𝐀</mi><mi>i</mi></msub><annotation encoding="application/x-tex">\mathbf A_i</annotation></semantics></math>
of the interpolation matrix
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>𝐀</mi><annotation encoding="application/x-tex">\mathbf A</annotation></semantics></math>
is nonzero for only the three vertices of the triangle that contains
sample
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math></p>
<ul>
<li>Simultaneous autoregressive (SAR): Alternatively, the analyst can
specify an areal model representing the value within spatial
strata:</li>
</ul>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>𝐐</mi><mrow><mi mathvariant="normal">d</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">m</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">n</mi></mrow></msub><mo>=</mo><msup><mi>τ</mi><mn>2</mn></msup><msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>𝐈</mi><mo>−</mo><mi>κ</mi><msup><mi>𝐀</mi><mo>*</mo></msup><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">
\mathbf Q_{\mathrm{domain}} = \tau^2 (\mathbf I - \kappa \mathbf A^*)^2 
</annotation></semantics></math> where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>𝐀</mi><mo>*</mo></msup><annotation encoding="application/x-tex">\mathbf A^*</annotation></semantics></math>
is the adjacency matrix of the graph specified by the analyst, and each
row
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>𝐀</mi><mi>i</mi></msub><annotation encoding="application/x-tex">\mathbf A_i</annotation></semantics></math>
of interpolation matrix
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>𝐀</mi><annotation encoding="application/x-tex">\mathbf A</annotation></semantics></math>
is nonzero only for the single spatial stratum containing sample
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>
(and noting that adjacency matrix
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>𝐀</mi><mo>*</mo></msup><annotation encoding="application/x-tex">\mathbf A^*</annotation></semantics></math>
is different from interpolation matrix
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>𝐀</mi><annotation encoding="application/x-tex">\mathbf A</annotation></semantics></math>,
but we use the same term for both due to a collision in standard
notation).</p>
<ul>
<li>Stream networks: Finally, the analyst can specify that sites are
partially correlated if they are adjacent along a stream network (while
ignoring flow direction). This results in an Onstein-Uhlenbeck process
along the stream network, or an exponential <code>tail-down</code>
model.</li>
</ul>
</div>
<div class="section level2">
<h2 id="structural-equation-models">Structural equation models<a class="anchor" aria-label="anchor" href="#structural-equation-models"></a>
</h2>
<p>tinyVAST also involves specifying a structural equation model (SEM).
This SEM be viewed either:</p>
<ol style="list-style-type: decimal">
<li>Weak interpretation: as a flexible way to parameterize the
correlation among variables; or</li>
<li>Strong interpretation: as a structural causal model, allowing
inference about counterfactual changes to the system.</li>
</ol>
<p>To specify a SEM, the user uses <em>arrow notation</em>. For example,
to specify a linear model this involves:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a>w1 <span class="ot">-&gt;</span> w2, b_12</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a>w1 <span class="ot">&lt;-</span><span class="er">&gt;</span> w1, sd_1</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a>w2 <span class="ot">&lt;-</span><span class="er">&gt;</span> w2, sd_2</span></code></pre></div>
<p>This then estimates a single slope parameter (represented with a
one-headed arrow), as well as the variance of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>W</mi><mn>1</mn></msub><annotation encoding="application/x-tex">W_1</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>W</mi><mn>2</mn></msub><annotation encoding="application/x-tex">W_2</annotation></semantics></math>
(specified with two-headed arrows). In a more complicated case,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>W</mi><mn>1</mn></msub><annotation encoding="application/x-tex">W_1</annotation></semantics></math>
might cause
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>W</mi><mn>2</mn></msub><annotation encoding="application/x-tex">W_2</annotation></semantics></math>,
which in turn causes
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>W</mi><mn>3</mn></msub><annotation encoding="application/x-tex">W_3</annotation></semantics></math>.
This is then represented as:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a>w1 <span class="ot">-&gt;</span> w2, b_12</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a>w2 <span class="ot">-&gt;</span> w3, b_23</span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a>w1 <span class="ot">&lt;-</span><span class="er">&gt;</span> w1, s_1</span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a>w2 <span class="ot">&lt;-</span><span class="er">&gt;</span> w2, s_2</span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a>w3 <span class="ot">&lt;-</span><span class="er">&gt;</span> w3, s_3</span></code></pre></div>
<p>Path coefficients for one-headed arrows then define path matrix
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>𝐏</mi><annotation encoding="application/x-tex">\mathbf P</annotation></semantics></math>:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>𝐏</mi><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>b</mi><mn>12</mn></msub></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>b</mi><mn>23</mn></msub></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">
\mathbf P = 
\begin{pmatrix}
  0 &amp; 0 &amp; 0 \\
  b_{12} &amp; 0 &amp; 0 \\
  0 &amp; b_{23} &amp; 0 
\end{pmatrix}
</annotation></semantics></math></p>
<p>and coefficents for two-headed arrows define the Cholesky
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>𝐆</mi><annotation encoding="application/x-tex">\mathbf G</annotation></semantics></math>
of the exnogenous covariance matrix
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>𝐆</mi><mi>T</mi></msup><mi>𝐆</mi></mrow><annotation encoding="application/x-tex">\mathbf G^T \mathbf G</annotation></semantics></math>:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>𝐆</mi><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>s</mi><mn>1</mn></msub></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>s</mi><mn>2</mn></msub></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>s</mi><mn>3</mn></msub></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">
\mathbf G = 
\begin{pmatrix}
  s_{1} &amp; 0 &amp; 0 \\
  0 &amp; s_{2} &amp; 0 \\
  0 &amp; 0 &amp; s_{3} 
\end{pmatrix}
</annotation></semantics></math></p>
<p>These matrices are define a simultaneous equation model:</p>
<p><span class="math display">$$
\mathbf{ w = P w + \epsilon} \\
\mathbf\epsilon \sim \mathrm{MVN}( \mathbf 0, \mathbf G^T \mathbf G )
$$</span> where the variance
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mi mathvariant="normal">V</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">r</mi></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>𝐰</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><mrow><mi>𝐈</mi><mo mathvariant="bold">−</mo><mi>𝐏</mi></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo>−</mo><mn>1</mn></mrow></msup><msup><mi>𝐆</mi><mn>2</mn></msup><msup><mrow><mo stretchy="true" form="prefix">(</mo><msup><mrow><mi>𝐈</mi><mo mathvariant="bold">−</mo><mi>𝐏</mi></mrow><mi>T</mi></msup><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo>−</mo><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">\mathrm{Var}(\mathbf w) = (\mathbf{I - P})^{-1} \mathbf G^2 (\mathbf{I - P}^T)^{-1}</annotation></semantics></math>.
This then results in a sparse precision matrix:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>𝐐</mi><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><msup><mrow><mi>𝐈</mi><mo mathvariant="bold">−</mo><mi>𝐏</mi></mrow><mi>T</mi></msup><mo stretchy="true" form="postfix">)</mo></mrow><msup><mi>𝐆</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><msup><mi>𝐆</mi><mrow><mo>−</mo><mi>T</mi></mrow></msup><mrow><mo stretchy="true" form="prefix">(</mo><mrow><mi>𝐈</mi><mo mathvariant="bold">−</mo><mi>𝐏</mi></mrow><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">
\mathbf Q = (\mathbf{I - P}^T) \mathbf G^{-1} \mathbf G^{-T} (\mathbf{I - P})
</annotation></semantics></math></p>
</div>
<div class="section level2">
<h2 id="dynamic-structural-equation-models">Dynamic structural equation models<a class="anchor" aria-label="anchor" href="#dynamic-structural-equation-models"></a>
</h2>
<p>Similarly, tinyVAST involves specifying dynamic structural equation
models (DSEM). To specify a DSEM, the user uses <em>arrow-and-lag
notation</em>. For example, to specify a univariate first-order
autoregressive process:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a>w1 <span class="ot">-&gt;</span> w1, <span class="dv">1</span>, rho</span></code></pre></div>
<p>If there were four time-intervals
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi><mo>=</mo><mn>4</mn></mrow><annotation encoding="application/x-tex">T=4</annotation></semantics></math>)
this would then result in the path matrix:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>𝐏</mi><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mi>ρ</mi></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mi>ρ</mi></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mi>ρ</mi></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">
\mathbf P = 
\begin{pmatrix}
  0 &amp; 0 &amp; 0 &amp; 0 \\
  \rho &amp; 0 &amp; 0 &amp; 0 \\
  0 &amp; \rho &amp; 0 &amp; 0 \\
  0 &amp; 0 &amp; \rho &amp; 0 
\end{pmatrix}
</annotation></semantics></math></p>
<p>and when the DSEM involves multiple times and variables, the sparse
precision is formed by summing across the Kronecker product of time-lag
and interaction matrices. This DSEM defines a GMRF over a nonseparable
interaction of time and variables, represented by a matrix
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>𝐐</mi><mrow><mi mathvariant="normal">t</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">m</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">_</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">m</mi></mrow></msub><annotation encoding="application/x-tex">\mathbf Q_{\mathrm{time\_term}}</annotation></semantics></math>
with dimension
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi><mi>T</mi><mo>×</mo><mi>C</mi><mi>T</mi></mrow><annotation encoding="application/x-tex">CT \times CT</annotation></semantics></math>.
The user can specify a separate <em>arrow-and-lag</em> notation to
define the precision matrix for the time-variable interaction
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>𝐐</mi><mrow><mi mathvariant="normal">t</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">m</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">_</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">m</mi></mrow></msub><annotation encoding="application/x-tex">\mathbf Q_{\mathrm{time\_term}}</annotation></semantics></math>
and for the space-time-variable interaction
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>𝐐</mi><mrow><mi mathvariant="normal">s</mi><mi mathvariant="normal">p</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">c</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">m</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">_</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">m</mi></mrow></msub><annotation encoding="application/x-tex">\mathbf Q_{\mathrm{spacetime\_term}}</annotation></semantics></math>.
The time term
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>𝐐</mi><mrow><mi mathvariant="normal">t</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">m</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">_</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">m</mi></mrow></msub><annotation encoding="application/x-tex">\mathbf Q_{\mathrm{time\_term}}</annotation></semantics></math>
is used to define the time-varying intercept for each variable:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mi mathvariant="normal">v</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">c</mi></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>𝐃</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>∼</mo><mrow><mi mathvariant="normal">M</mi><mi mathvariant="normal">V</mi><mi mathvariant="normal">N</mi></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mn>𝟎</mn><mo>,</mo><msub><mi>𝐐</mi><mrow><mi mathvariant="normal">t</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">m</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">_</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">m</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">
\mathrm{vec}(\mathbf D) \sim \mathrm{MVN}(\mathbf 0, \mathbf Q_{\mathrm{time\_term}})
</annotation></semantics></math> Meanwhile, the space-time term
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>𝐐</mi><mrow><mi mathvariant="normal">s</mi><mi mathvariant="normal">p</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">c</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">m</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">_</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">m</mi></mrow></msub><annotation encoding="application/x-tex">\mathbf Q_{\mathrm{spacetime\_term}}</annotation></semantics></math>
is combined with the spatial precision
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>𝐐</mi><mrow><mi mathvariant="normal">s</mi><mi mathvariant="normal">p</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">c</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">_</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">m</mi></mrow></msub><annotation encoding="application/x-tex">\mathbf Q_{\mathrm{space\_term}}</annotation></semantics></math>
as we explain next.</p>
</div>
<div class="section level2">
<h2 id="spatial-interactions-for-sem-and-dsem">Spatial interactions for SEM and DSEM<a class="anchor" aria-label="anchor" href="#spatial-interactions-for-sem-and-dsem"></a>
</h2>
<p>tinyVAST uses the SEM and DSEM notation to construct the joint
precision for the space-variable interaction
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>𝛀</mi><annotation encoding="application/x-tex">\mathbf\Omega</annotation></semantics></math>
with dimension
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mo>×</mo><mi>C</mi></mrow><annotation encoding="application/x-tex">S \times C</annotation></semantics></math>,
and the space-time-variable interaction
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>𝐄</mi><annotation encoding="application/x-tex">\mathbf E</annotation></semantics></math>
with dimension
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mo>×</mo><mi>C</mi><mo>×</mo><mi>T</mi></mrow><annotation encoding="application/x-tex">S \times C \times T</annotation></semantics></math>.
To do so, it constructs the separable precision for each process:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mi mathvariant="normal">v</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">c</mi></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>𝐄</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>∼</mo><mrow><mi mathvariant="normal">M</mi><mi mathvariant="normal">V</mi><mi mathvariant="normal">N</mi></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mn>𝟎</mn><mo>,</mo><msub><mi>𝐐</mi><mrow><mi mathvariant="normal">s</mi><mi mathvariant="normal">p</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">c</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">m</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">_</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">m</mi></mrow></msub><mo>⊗</mo><msub><mi>𝐐</mi><mrow><mi mathvariant="normal">d</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">m</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">n</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">
\mathrm{vec}(\mathbf E) \sim \mathrm{MVN}(\mathbf 0, \mathbf Q_{\mathrm{spacetime\_term}} \otimes \mathbf Q_{\mathrm{domain}})
</annotation></semantics></math></p>
<p>where the precision matrix
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>𝐐</mi><mrow><mi mathvariant="normal">s</mi><mi mathvariant="normal">p</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">c</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">m</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">_</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">m</mi></mrow></msub><mo>⊗</mo><msub><mi>𝐐</mi><mrow><mi mathvariant="normal">d</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">m</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">n</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\mathbf Q_{\mathrm{spacetime\_term}} \otimes \mathbf Q_{\mathrm{domain}}</annotation></semantics></math>
has dimension
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mi>T</mi><mi>C</mi><mo>×</mo><mi>S</mi><mi>T</mi><mi>C</mi></mrow><annotation encoding="application/x-tex">STC \times STC</annotation></semantics></math>
to match the length of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mi mathvariant="normal">v</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">c</mi></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>𝐄</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\mathrm{vec}(\mathbf E)</annotation></semantics></math>,
and
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mi mathvariant="normal">v</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">c</mi></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>𝛀</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>∼</mo><mrow><mi mathvariant="normal">M</mi><mi mathvariant="normal">V</mi><mi mathvariant="normal">N</mi></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mn>𝟎</mn><mo>,</mo><msub><mi>𝐐</mi><mrow><mi mathvariant="normal">s</mi><mi mathvariant="normal">p</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">c</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">_</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">m</mi></mrow></msub><mo>⊗</mo><msub><mi>𝐐</mi><mrow><mi mathvariant="normal">d</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">m</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">n</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">
\mathrm{vec}(\mathbf\Omega) \sim \mathrm{MVN}(\mathbf 0, \mathbf Q_{\mathrm{space\_term}} \otimes \mathbf Q_{\mathrm{domain}})
</annotation></semantics></math></p>
<p>where the precision matrix
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>𝐐</mi><mrow><mi mathvariant="normal">s</mi><mi mathvariant="normal">p</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">c</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">_</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">m</mi></mrow></msub><mo>⊗</mo><msub><mi>𝐐</mi><mrow><mi mathvariant="normal">d</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">m</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">n</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\mathbf Q_{\mathrm{space\_term}} \otimes \mathbf Q_{\mathrm{domain}}</annotation></semantics></math>
has dimension
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mi>C</mi><mo>×</mo><mi>S</mi><mi>C</mi></mrow><annotation encoding="application/x-tex">SC \times SC</annotation></semantics></math>,
to match the length of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mi mathvariant="normal">v</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">c</mi></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>𝛀</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\mathrm{vec}(\mathbf\Omega)</annotation></semantics></math>.</p>
</div>
<div class="section level2">
<h2 id="generalized-additive-model">Generalized additive model<a class="anchor" aria-label="anchor" href="#generalized-additive-model"></a>
</h2>
<p>Finally, the analyst can specify a generalized additive model using
syntax from package mgcv. For example this might involve:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">count</span> <span class="op">~</span> <span class="va">year</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/offset.html" class="external-link">offset</a></span><span class="op">(</span><span class="va">log_area</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/s.html" class="external-link">s</a></span><span class="op">(</span><span class="va">depth</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/s.html" class="external-link">s</a></span><span class="op">(</span><span class="va">species</span>, bs<span class="op">=</span><span class="st">"re"</span><span class="op">)</span></span></code></pre></div>
<p>If <code>year</code> and <code>species</code> are factors and
<code>depth</code> and <code>log_area</code> are continuous, then this
would specify a fixed effect for each level <code>year</code>, a spline
smoother for <code>depth</code>, using <code>log_area</code> as an
offset, and estimating a random intercept for each level of
<code>species</code>. This formula is parsed internally to assemble
fixed effects in design matrix
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>𝐗</mi><annotation encoding="application/x-tex">\mathbf X</annotation></semantics></math>
and the basis functions for spline smoothers and random effects in
design matrix
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>𝐙</mi><annotation encoding="application/x-tex">\mathbf Z</annotation></semantics></math>.
The coefficients
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>𝛄</mi><annotation encoding="application/x-tex">\mathbf\gamma</annotation></semantics></math>
associated with smoothers and random effects are then specified to
follow a GMRF:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>𝛄</mi><mo>∼</mo><mrow><mi mathvariant="normal">G</mi><mi mathvariant="normal">M</mi><mi mathvariant="normal">R</mi><mi mathvariant="normal">F</mi></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mn>𝟎</mn><mo>,</mo><msub><mi>𝐐</mi><mrow><mi mathvariant="normal">g</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">m</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">
\mathbf\gamma \sim \mathrm{GMRF}( \mathbf 0, \mathbf Q_{\mathrm{gam}})
</annotation></semantics></math> where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>𝐐</mi><mrow><mi mathvariant="normal">g</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">m</mi></mrow></msub><annotation encoding="application/x-tex">\mathbf Q_{\mathrm{gam}}</annotation></semantics></math>
is a blockwise diagonal matrix, assembled from estimated variance
parameters and matrices constructed by mgcv.</p>
<table class="table">
<caption>Table 1: Subscript notation</caption>
<thead><tr class="header">
<th align="left">Symbol</th>
<th align="left">Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left"><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math></td>
<td align="left">Index for each sample,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>
in
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>,</mo><mn>2</mn><mo>,</mo><mi>.</mi><mi>.</mi><mi>.</mi><mo>,</mo><mi>I</mi><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(1,2,...,I)</annotation></semantics></math>
</td>
</tr>
<tr class="even">
<td align="left"><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>i</mi><mo stretchy="true" form="postfix">]</mo></mrow></mrow><annotation encoding="application/x-tex">s[i]</annotation></semantics></math></td>
<td align="left">spatial coordinate for sample
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>s</mi><annotation encoding="application/x-tex">s</annotation></semantics></math>
in
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>,</mo><mn>2</mn><mo>,</mo><mi>.</mi><mi>.</mi><mi>.</mi><mo>,</mo><mi>S</mi><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(1,2,...,S)</annotation></semantics></math>
</td>
</tr>
<tr class="odd">
<td align="left"><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>i</mi><mo stretchy="true" form="postfix">]</mo></mrow></mrow><annotation encoding="application/x-tex">t[i]</annotation></semantics></math></td>
<td align="left">time-interval for sample
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>t</mi><annotation encoding="application/x-tex">t</annotation></semantics></math>
in
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>,</mo><mn>2</mn><mo>,</mo><mi>.</mi><mi>.</mi><mi>.</mi><mo>,</mo><mi>T</mi><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(1,2,...,T)</annotation></semantics></math>
</td>
</tr>
<tr class="even">
<td align="left"><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>i</mi><mo stretchy="true" form="postfix">]</mo></mrow></mrow><annotation encoding="application/x-tex">c[i]</annotation></semantics></math></td>
<td align="left">category for sample
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>c</mi><annotation encoding="application/x-tex">c</annotation></semantics></math>
in
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>,</mo><mn>2</mn><mo>,</mo><mi>.</mi><mi>.</mi><mi>.</mi><mo>,</mo><mi>C</mi><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(1,2,...,C)</annotation></semantics></math>
</td>
</tr>
<tr class="odd">
<td align="left"><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>e</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>i</mi><mo stretchy="true" form="postfix">]</mo></mrow></mrow><annotation encoding="application/x-tex">e[i]</annotation></semantics></math></td>
<td align="left">error distribution and link function for sample
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>
</td>
</tr>
</tbody>
</table>
<table class="table">
<caption>Table 2: Symbol notation, code representation (in model output
or in model template code), and descriptions.</caption>
<thead><tr class="header">
<th align="left">Symbol</th>
<th align="left">Code</th>
<th align="left">Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left"><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>y</mi><annotation encoding="application/x-tex">y</annotation></semantics></math></td>
<td align="left"><code>y_i</code></td>
<td align="left">Observed response data</td>
</tr>
<tr class="even">
<td align="left"><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>p</mi><mn>1</mn></msub><annotation encoding="application/x-tex">p_1</annotation></semantics></math></td>
<td align="left"><code>p_i</code></td>
<td align="left">first linear predictor</td>
</tr>
<tr class="odd">
<td align="left"><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>p</mi><mn>2</mn></msub><annotation encoding="application/x-tex">p_2</annotation></semantics></math></td>
<td align="left"><code>p2_i</code></td>
<td align="left">second linear predictor</td>
</tr>
</tbody>
</table>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by James T. Thorson, Sean C. Anderson.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
